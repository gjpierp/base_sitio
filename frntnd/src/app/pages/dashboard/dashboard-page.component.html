<div class="dashboard-container">
  <!-- Encabezado con botón de refrescar -->
  <div
    style="
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    "
  >
    <div>
      <h2 style="margin: 0; font-weight: bold; font-size: 20px">{{ title }}</h2>
      <div style="color: #888; font-size: 14px; margin-top: 0.2em">{{ subtitle }}</div>
    </div>
    <ui-button
      variant="secondary"
      icon="refresh"
      [iconOnly]="true"
      ariaLabel="Refrescar"
      title="Refrescar datos"
      (pressed)="refrescar()"
    ></ui-button>
  </div>

  <div
    *ngIf="loading && !datosListos"
    style="display: flex; justify-content: center; padding: 2rem"
  >
    <ui-spinner label="Cargando dashboard..."></ui-spinner>
  </div>

  <ng-container *ngIf="datosListos">
    <!-- Tarjetas de Estadísticas -->
    <div class="stats-grid">
      <ui-card class="stat-card" (click)="irA('/usuarios')" style="cursor: pointer">
        <div class="stat-content">
          <div class="stat-value">{{ stats.usuarios }}</div>
          <div class="stat-label">Usuarios</div>
        </div>
      </ui-card>

      <ui-card class="stat-card" (click)="irA('/aplicaciones-sitio')" style="cursor: pointer">
        <div class="stat-content">
          <div class="stat-value">{{ stats.apps }}</div>
          <div class="stat-label">Aplicaciones</div>
        </div>
      </ui-card>

      <ui-card class="stat-card" (click)="irA('/configuracion')" style="cursor: pointer">
        <div class="stat-content">
          <div class="stat-value">{{ stats.config }}</div>
          <div class="stat-label">Configuraciones</div>
        </div>
      </ui-card>
    </div>

    <!-- Tabla de Actividad Reciente -->
    <div style="margin-top: 2rem">
      <ui-card title="Actividad Reciente del Sistema">
        <ui-entity-table
          [columns]="activityColumns"
          [data]="formattedActivity"
          [total]="0"
          [loading]="loading"
          [error]="error"
          [page]="1"
          [pageSize]="5"
          (edit)="onEdit($event)"
          class="w-full mx-auto block"
        ></ui-entity-table>
      </ui-card>
    </div>
  </ng-container>
</div>
